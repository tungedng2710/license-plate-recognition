<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>YOLOv9 Trainer</title>
  <style>
    .card { border: 1px solid #ccc; padding: 8px; margin: 4px; display:inline-block; cursor:pointer; }
  </style>
</head>
<body>
  <h1>Available Datasets</h1>
  <div id="datasets"></div>
  <h2>Training Configuration</h2>
  <form id="trainForm">
    <label>Dataset: <input id="dataset" required /></label><br/>
    <label>Batch Size: <input type="number" id="batch" value="16" /></label><br/>
    <label>Image Size: <input type="number" id="img" value="640" /></label><br/>
    <label>Model:
      <select id="model">
        <option value="m">yolov9-m</option>
        <option value="c">yolov9-c</option>
        <option value="t">yolov9-t</option>
      </select>
    </label><br/>
    <label>Epochs: <input type="number" id="epochs" value="100" /></label><br/>
    <button type="submit">Train</button>
  </form>
  <script>
    async function loadDatasets() {
      const res = await fetch('/api/datasets');
      const data = await res.json();
      const container = document.getElementById('datasets');
      container.innerHTML = '';
      data.datasets.forEach(ds => {
        const div = document.createElement('div');
        div.className = 'card';
        div.textContent = ds;
        div.onclick = () => document.getElementById('dataset').value = ds;
        container.appendChild(div);
      });
    }
    document.getElementById('trainForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const payload = {
        dataset: document.getElementById('dataset').value,
        batch: parseInt(document.getElementById('batch').value),
        img_size: parseInt(document.getElementById('img').value),
        model: document.getElementById('model').value,
        epochs: parseInt(document.getElementById('epochs').value)
      };
      await fetch('/api/train', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(payload)
      });
      alert('Training started');
    });
    window.onload = loadDatasets;
  </script>
</body>
</html>
